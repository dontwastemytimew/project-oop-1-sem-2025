#ifndef USERLOGGER_H
#define USERLOGGER_H

#include <QFile>
#include <QDateTime>
#include <QDebug>

/**
 * @brief Перерахування рівнів важливості логів.
 *
 * Використовується для класифікації повідомлень, що дозволяє
 * легко фільтрувати логи під час аналізу (наприклад, шукати тільки помилки).
 */
enum LogLevel {
    Debug,    ///< Детальна технічна інформація для розробників (значення змінних, хід виконання).
    Info,     ///< Стандартні інформаційні повідомлення про хід роботи (напр., "Користувач увійшов").
    Warning,  ///< Попередження про нештатні ситуації, які не зупиняють роботу (напр., "Файл конфігурації не знайдено, використано дефолтний").
    Error,    ///< Помилки, які переривають виконання поточної операції (напр., "Не вдалося зберегти профіль").
    Critical  ///< Критичні збої, що унеможливлюють подальшу роботу (напр., "База даних недоступна").
};

/**
 * @brief Статичний клас-утиліта для логування подій.
 *
 * Забезпечує централізований механізм запису діагностичних повідомлень.
 * Особливістю класу є те, що він записує дані одночасно у два потоки:
 * 1. У консоль налагодження (через qDebug()), що зручно при розробці в IDE.
 * 2. У текстовий файл на диску, що дозволяє аналізувати проблеми після запуску (post-mortem analysis).
 *
 * Всі методи є статичними, тому створювати екземпляр класу не потрібно.
 */
class UserLogger {
public:
    /**
     * @brief Ініціалізує систему логування.
     *
     * Цей метод відкриває файл для запису логів. Якщо файл не існує, він створюється.
     * Якщо існує — нові записи додаються в кінець (append).
     * Метод повинен бути викликаний один раз на початку роботи програми (у main.cpp).
     *
     * @param fileName Ім'я або повний шлях до файлу логів (за замовчуванням "app_log.txt").
     */
    static void init(const QString &fileName = "app_log.txt");

    /**
     * @brief Записує повідомлення у лог.
     *
     * Форматує повідомлення, додаючи до нього поточну дату, час та рівень важливості.
     * Записане повідомлення виводиться в консоль та зберігається у файл.
     *
     * Формат виводу: `[YYYY-MM-DD HH:MM:SS] [LEVEL] Message`
     *
     * @param level Рівень важливості повідомлення (Debug, Info, Error тощо).
     * @param message Текст повідомлення.
     */
    static void log(LogLevel level, const QString &message);

private:
    /**
     * @brief Вказівник на об'єкт файлу, куди ведеться запис.
     * Ініціалізується у методі init().
     */
    static QFile *logFile;

    /**
     * @brief Прапорець стану ініціалізації.
     * Запобігає спробам запису у файл, якщо він не був успішно відкритий.
     */
    static bool initialized;
};

#endif // USERLOGGER_H

#endif //USERLOGGER_H
